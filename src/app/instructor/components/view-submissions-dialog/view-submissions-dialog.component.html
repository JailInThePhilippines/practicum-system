<div mat-dialog-content class="container-fluid mb-5 mt-3">
  <!-- Student profile information -->
  <div class="row mb-3 align-items-center">
    <div class="col-auto ml-5">
      <img
        [src]="profilePictureUrl"
        alt="Profile Picture"
        class="rounded-circle"
        style="width: 100px; height: 100px"
      />
    </div>
    <div class="col">
      <div>
        <h2 class="mb-0 text-dark">{{ data.student.student_name }}</h2>
        <p class="text-muted mt-1">
          {{ data.student.student_email }} <br />
          {{ data.student.program }} - {{ data.student.student_year
          }}{{ data.student.block }}
        </p>
      </div>
    </div>
    <div class="col-auto ml-auto">
      <button mat-button (click)="onNoClick()">X</button>
    </div>
  </div>

  <hr />

  <!-- Signed Documents Table -->
  <div class="mt-5 container">
    <h4 class="mt-5 text-dark"><b>Requirements</b></h4>

    <table mat-table [dataSource]="signedDocuments" class="mat-elevation-z8">
      <!-- Document Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Document</th>
        <td mat-cell *matCellDef="let element">{{ element.name }}
          <span *ngIf="element.name === 'MOA'" class="text-info">(Only if required by the student's company)</span>
        </td>
      </ng-container>

      <!-- View Link Column -->
      <ng-container matColumnDef="view">
        <th mat-header-cell *matHeaderCellDef>View</th>
        <td mat-cell *matCellDef="let element">
          <a
            mat-icon-button
            *ngIf="element.path"
            (click)="openDocument(element.path)"
            class="text-primary text-decoration-underline"
            ><mat-icon>open_in_new</mat-icon></a
          >
          <span *ngIf="!element.path">Not Available</span>
        </td>
      </ng-container>

      <!-- Status Given Column -->
      <ng-container matColumnDef="statusGiven">
        <th mat-header-cell *matHeaderCellDef>Status Given</th>
        <td mat-cell *matCellDef="let element">
          <span [ngStyle]="getDocumentStatusStyle(element.status)">{{
            element.status
          }}</span>
        </td>
      </ng-container>

      <!-- Set Status Column -->
      <ng-container matColumnDef="setStatus">
        <th mat-header-cell *matHeaderCellDef>Set Status</th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button (click)="setStatus(element, 'Cleared')">
            <mat-icon>check_circle</mat-icon>
          </button>
          <button
            mat-icon-button
            (click)="setStatus(element, 'Currently Verifying')"
          >
            <mat-icon>hourglass_empty</mat-icon>
          </button>
          <button mat-icon-button (click)="setStatus(element, 'Not Cleared')">
            <mat-icon>cancel</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['name', 'view', 'statusGiven', 'setStatus']"
      ></tr>
      <tr
        mat-row
        *matRowDef="
          let row;
          columns: ['name', 'view', 'statusGiven', 'setStatus']
        "
      ></tr>
    </table>
  </div>

  <!-- DTR Files Table -->
  <div class="container mt-5">
    <h4 class="text-dark"><b>Daily Time In Out Record</b></h4>

    <table mat-table [dataSource]="dtrDocuments" class="mat-elevation-z8">
      <!-- Document Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Document</th>
        <td mat-cell *matCellDef="let element">{{ element.name }}</td>
      </ng-container>

      <!-- File Name Column -->
      <ng-container matColumnDef="file_name">
        <th mat-header-cell *matHeaderCellDef>File Name</th>
        <td mat-cell *matCellDef="let element">{{ element.file_name }}</td>
      </ng-container>

      <!-- DTR Status Column -->
      <ng-container matColumnDef="dtr_status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td
          mat-cell
          *matCellDef="let element"
          [ngStyle]="getDtrStatusStyle(element.dtr_status)"
        >
          {{ element.dtr_status }}
        </td>
      </ng-container>

      <!-- View Link Column -->
      <ng-container matColumnDef="view">
        <th mat-header-cell *matHeaderCellDef>View</th>
        <td mat-cell *matCellDef="let element">
          <a
            mat-icon-button
            *ngIf="element.path"
            (click)="openDocument(element.path)"
            class="text-primary text-decoration-underline"
            ><mat-icon>open_in_new</mat-icon></a
          >
          <span *ngIf="!element.path">Not Available</span>
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['name', 'file_name', 'dtr_status', 'view']"
      ></tr>
      <tr
        mat-row
        *matRowDef="
          let row;
          columns: ['name', 'file_name', 'dtr_status', 'view']
        "
      ></tr>
    </table>
  </div>

  <!-- Weekly Accomplishments Table -->
  <div class="mt-5 container">
    <h4 class="mt-5 text-dark"><b>Weekly Accomplishments</b></h4>

    <table
      mat-table
      [dataSource]="accomplishmentDocuments"
      class="mat-elevation-z8"
    >
      <!-- File Name Column -->
      <ng-container matColumnDef="file_name">
        <th mat-header-cell *matHeaderCellDef>File Name</th>
        <td mat-cell *matCellDef="let element">{{ element.file_name }}</td>
      </ng-container>

      <!-- Weekly Status Column -->
      <ng-container matColumnDef="weekly_status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td
          mat-cell
          *matCellDef="let element"
          [ngStyle]="getAccomplishmentStatusStyle(element.weekly_status)"
        >
          {{ element.weekly_status }}
        </td>
      </ng-container>

      <!-- View Link Column -->
      <ng-container matColumnDef="view">
        <th mat-header-cell *matHeaderCellDef>View</th>
        <td mat-cell *matCellDef="let element">
          <a
            mat-icon-button
            *ngIf="element.path"
            (click)="openDocument(element.path)"
            class="text-primary text-decoration-underline"
            ><mat-icon>open_in_new</mat-icon></a
          >
          <span *ngIf="!element.path">Not Available</span>
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['file_name', 'weekly_status', 'view']"
      ></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: ['file_name', 'weekly_status', 'view']"
      ></tr>
    </table>
    <div class="container mt-3">
      <mat-paginator
        #weeklyPaginator
        [pageSizeOptions]="[1, 5, 10, 25]"
        showFirstLastButtons
      ></mat-paginator>
    </div>
  </div>

  <!-- Activities Documents Table -->
<div class="container mt-5">
  <h4 class="text-dark mt-5"><b>Documents</b></h4>

  <table mat-table [dataSource]="getSortedDocuments()" class="mat-elevation-z8">
    <!-- Document Name Column -->
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Document</th>
      <td mat-cell *matCellDef="let element">{{ element.name }}</td>
    </ng-container>

    <!-- View Link Column -->
    <ng-container matColumnDef="view">
      <th mat-header-cell *matHeaderCellDef>View</th>
      <td mat-cell *matCellDef="let element">
        <a
          mat-icon-button
          *ngIf="element.path"
          (click)="openDocument(element.path)"
          class="text-primary text-decoration-underline"
          ><mat-icon>open_in_new</mat-icon></a
        >
        <span *ngIf="!element.path">Not Available</span>
      </td>
    </ng-container>

    <!-- Status Given Column -->
    <ng-container matColumnDef="statusGiven">
      <th mat-header-cell *matHeaderCellDef>Status Given</th>
      <td mat-cell *matCellDef="let element">
        <span [ngStyle]="getDocumentStatusStyle(element.status)">{{
          element.status
        }}</span>
      </td>
    </ng-container>

    <!-- Set Status Column -->
    <ng-container matColumnDef="setStatus">
      <th mat-header-cell *matHeaderCellDef>Set Status</th>
      <td mat-cell *matCellDef="let element">
        <ng-container *ngIf="element.name !== 'Final Report'; else finalReportButtons">
          <button mat-icon-button (click)="setStatus(element, 'Cleared')">
            <mat-icon>check_circle</mat-icon>
          </button>
          <button
            mat-icon-button
            (click)="setStatus(element, 'Currently Verifying')"
          >
            <mat-icon>hourglass_empty</mat-icon>
          </button>
          <button mat-icon-button (click)="setStatus(element, 'Not Cleared')">
            <mat-icon>cancel</mat-icon>
          </button>
        </ng-container>
        <ng-template #finalReportButtons>
          <button mat-icon-button (click)="setReportStatus(element, 'Cleared')">
            <mat-icon>check_circle</mat-icon>
          </button>
          <button
            mat-icon-button
            (click)="setReportStatus(element, 'Currently Verifying')"
          >
            <mat-icon>hourglass_empty</mat-icon>
          </button>
          <button
            mat-icon-button
            (click)="setReportStatus(element, 'Not Cleared')"
          >
            <mat-icon>cancel</mat-icon>
          </button>
        </ng-template>
      </td>
    </ng-container>

    <tr
      mat-header-row
      *matHeaderRowDef="['name', 'view', 'statusGiven', 'setStatus']"
    ></tr>
    <tr
      mat-row
      *matRowDef="let row; columns: ['name', 'view', 'statusGiven', 'setStatus']"
    ></tr>
  </table>
</div>

  <!-- Certificate of Completion Table -->
  <div class="mt-5 container">
    <h4 class="mt-5 text-dark"><b>Certificate of Completion</b></h4>

    <table
      mat-table
      [dataSource]="certificateDocuments"
      class="mat-elevation-z8"
    >
      <!-- Document Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Document</th>
        <td mat-cell *matCellDef="let element">{{ element.name }}</td>
      </ng-container>

      <!-- View Link Column -->
      <ng-container matColumnDef="view">
        <th mat-header-cell *matHeaderCellDef>View</th>
        <td mat-cell *matCellDef="let element">
          <a
            mat-icon-button
            *ngIf="element.path"
            (click)="openDocument(element.path)"
            class="text-primary text-decoration-underline"
            ><mat-icon>open_in_new</mat-icon></a
          >
          <span *ngIf="!element.path">Not Available</span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['name', 'view']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['name', 'view']"></tr>
    </table>
  </div>

  <!-- Employer Feedback Table -->
  <div class="container mt-5">
    <h4 class="text-dark"><b>Student's Work Evaluation Score</b></h4>
    <table mat-table [dataSource]="employerFeedback" class="mat-elevation-z8">
      <!-- Knowledge Score Column -->
      <ng-container matColumnDef="knowledge_score">
        <th mat-header-cell *matHeaderCellDef>Knowledge Score</th>
        <td mat-cell *matCellDef="let element">
          {{ element.knowledge_score }}/25
        </td>
      </ng-container>

      <!-- Skills Score Column -->
      <ng-container matColumnDef="skills_score">
        <th mat-header-cell *matHeaderCellDef>Skills Score</th>
        <td mat-cell *matCellDef="let element">
          {{ element.skills_score }}/40
        </td>
      </ng-container>

      <!-- Attitude Score Column -->
      <ng-container matColumnDef="attitude_score">
        <th mat-header-cell *matHeaderCellDef>Attitude Score</th>
        <td mat-cell *matCellDef="let element">
          {{ element.attitude_score }}/65
        </td>
      </ng-container>

      <!-- Overall Performance Column -->
      <ng-container matColumnDef="overall_performance">
        <th mat-header-cell *matHeaderCellDef>Overall Performance</th>
        <td mat-cell *matCellDef="let element">
          {{ element.overall_performance }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>

  <!-- Exit Poll Table -->
<div class="container mt-5">
  <h4 class="text-dark"><b>Exit Poll</b></h4>
  <table mat-table [dataSource]="exitPollData" class="mat-elevation-z8">
    <!-- Category Column -->
    <ng-container matColumnDef="category">
      <th mat-header-cell *matHeaderCellDef>Category</th>
      <td mat-cell *matCellDef="let element">{{ element.category }}</td>
    </ng-container>

    <!-- Data Column -->
    <ng-container matColumnDef="data">
      <th mat-header-cell *matHeaderCellDef>Data</th>
      <td mat-cell *matCellDef="let element">{{ element.data }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="['category', 'data']"></tr>
    <tr mat-row *matRowDef="let row; columns: ['category', 'data']"></tr>
  </table>
  <div class="container mt-3">
    <mat-paginator
      #exitPollPaginator
      [pageSizeOptions]="[1, 5, 10, 25]"
      showFirstLastButtons
    ></mat-paginator>
  </div>
</div>

  <!-- PDF Generation Button -->
  <div class="container text-end mt-4 mb-5">
    <button mat-stroked-button color="primary" (click)="generatePDF()">
      Generate Report
    </button>
  </div>
</div>
